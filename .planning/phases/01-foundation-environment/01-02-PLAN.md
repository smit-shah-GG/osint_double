---
phase: 01-foundation-environment
plan: 02
type: execute
---

<objective>
Configure application settings, production-grade logging, and CLI framework.

Purpose: Establish robust configuration management and observability from day one.
Output: Working configuration system with Pydantic, structured logging with loguru, and interactive CLI with Typer.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-environment/01-CONTEXT.md
@.planning/phases/01-foundation-environment/01-RESEARCH.md
@.planning/phases/01-foundation-environment/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Pydantic settings models</name>
  <files>osint_system/config/settings.py, .env.example</files>
  <action>
    Create osint_system/config/__init__.py (empty).
    Create settings.py with BaseSettings model:
    - gemini_api_key: str (from env)
    - gemini_model: str = "gemini-1.5-pro"
    - max_rpm: int = 15 (free tier default)
    - max_tpm: int = 1_000_000
    - log_level: str = "INFO"
    - log_format: str = "json" (json or console)
    - interactive_mode: bool = True
    Use class Config with env_file=".env", env_file_encoding="utf-8".
    Create singleton: settings = Settings().
    Create .env.example with:
    GEMINI_API_KEY=your-api-key-here
    LOG_LEVEL=INFO
    LOG_FORMAT=console
  </action>
  <verify>uv run python -c "from osint_system.config.settings import settings; print(settings.log_level)" returns INFO</verify>
  <done>Settings model created, environment variables loadable, .env.example provided</done>
</task>

<task type="auto">
  <name>Task 2: Set up loguru with production/dev modes</name>
  <files>osint_system/config/logging.py</files>
  <action>
    Create logging.py to configure loguru based on settings:
    Import sys, loguru.logger, and settings.
    Remove default handler: logger.remove().
    If sys.stderr.isatty() and settings.log_format == "console":
      Add colorized console handler with format="{time} {level} {message}".
    Else (production):
      Add JSON handler to sys.stdout with serialize=True, diagnose=False.
    Set level from settings.log_level.
    Export configured logger.
    Create function get_logger(name) that returns logger.bind(component=name) for component-specific logging.
  </action>
  <verify>uv run python -c "from osint_system.config.logging import logger; logger.info('Test')" outputs formatted log</verify>
  <done>Loguru configured with automatic dev/prod detection, JSON in production, pretty console in dev</done>
</task>

<task type="auto">
  <name>Task 3: Create basic CLI with Typer</name>
  <files>osint_system/cli/__init__.py, osint_system/cli/main.py</files>
  <action>
    Create cli package with __init__.py.
    Create main.py with Typer app:
    Import typer, rich.console.Console, rich.table.Table.
    Create app = typer.Typer(help="OSINT Intelligence System CLI").
    Add @app.command() status():
      Show system status in a Rich table with Component, Status, Details columns.
      Add rows: "Environment" (Ready, Python 3.11 + uv), "Gemini API" (Configured, model from settings), "Logging" (Active, format from settings).
    Add @app.command() agent(name: str = typer.Option(..., prompt=True), task: str = typer.Option(..., prompt=True)):
      Print f"Would run agent {name} with task: {task}" (placeholder).
    Add if __name__ == "__main__": app().
    Make CLI executable: chmod +x osint_system/cli/main.py.
  </action>
  <verify>uv run python -m osint_system.cli.main status shows status table, uv run python -m osint_system.cli.main --help shows commands</verify>
  <done>Interactive CLI created with status command and agent placeholder, Rich formatting working</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Settings load from environment variables
- [ ] Logger outputs JSON in production mode
- [ ] CLI status command displays formatted table
- [ ] CLI agent command prompts for input
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Configuration loads from .env
- Logging switches between dev/prod automatically
- CLI provides interactive commands
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-environment/01-02-SUMMARY.md`:

# Phase 1 Plan 2: Configuration & Logging Infrastructure Summary

**Implemented production-grade configuration, logging, and CLI foundation.**

## Accomplishments

- Created Pydantic settings with environment variable support
- Configured loguru with automatic dev/prod detection
- Built interactive CLI with Typer and Rich

## Files Created/Modified

- `osint_system/config/settings.py` - Pydantic settings model
- `osint_system/config/logging.py` - Loguru configuration
- `osint_system/cli/main.py` - Typer CLI application
- `.env.example` - Environment variable template

## Decisions Made

- JSON logging in production, colorized console in development
- Settings singleton pattern for global access
- Rich tables for beautiful CLI output

## Issues Encountered

None - infrastructure established as planned.

## Next Step

Ready for 01-03-PLAN.md (Gemini API Integration)
</output>
---
phase: 03-planning-orchestration
plan: 02
type: execute
---

<objective>
Implement task queue and distribution system with prioritization logic and coverage metrics tracking.

Purpose: Enable intelligent task distribution based on signal strength, coverage goals, and agent capabilities.
Output: Working task queue with prioritization, signal analysis, and coverage tracking integrated with PlanningOrchestrator.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/3-planning-orchestration/03-RESEARCH.md
@.planning/phases/3-planning-orchestration/03-CONTEXT.md
@.planning/phases/3-planning-orchestration/03-01-SUMMARY.md
@osint_system/agents/planning_agent.py
@osint_system/orchestration/state_schemas.py
@osint_system/agents/registry.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create task queue with prioritization</name>
  <files>osint_system/orchestration/task_queue.py</files>
  <action>
    Create TaskQueue class with priority-based task management. Implement Task dataclass with fields: id, objective, priority (0-1), created_at, assigned_agent, status, metadata.

    Add methods: add_task (with auto-priority calculation), get_next_task (highest priority), update_task_status, get_pending_tasks. Use heapq for efficient priority queue operations.

    Implement basic priority scoring: keyword relevance (0.4 weight), recency (0.2 weight), retry count penalty (0.2 weight), source diversity bonus (0.2 weight).

    Avoid complex ML scoring for now - use simple heuristics. Don't implement persistence yet - use in-memory storage.
  </action>
  <verify>python -c "from osint_system.orchestration.task_queue import TaskQueue, Task; q = TaskQueue(); print('TaskQueue created successfully')"</verify>
  <done>TaskQueue class with priority-based operations, Task dataclass defined</done>
</task>

<task type="auto">
  <name>Task 2: Implement signal analysis and coverage metrics</name>
  <files>osint_system/orchestration/refinement/analysis.py</files>
  <action>
    Create signal analysis module with calculate_signal_strength function analyzing findings for relevance indicators. Return 0-1 score based on: keyword matches, entity mentions, source credibility, information density.

    Implement CoverageMetrics class tracking: source_diversity (unique sources / target sources), geographic_coverage (unique locations mentioned), temporal_coverage (time range of findings), topic_completeness (covered subtopics / total subtopics).

    Add check_diminishing_returns function comparing new findings to existing ones, returning novelty score (0-1).
  </action>
  <verify>python -c "from osint_system.orchestration.refinement.analysis import calculate_signal_strength, CoverageMetrics; print('Analysis module loaded')"</verify>
  <done>Signal strength calculation, coverage metrics tracking, diminishing returns detection</done>
</task>

<task type="auto">
  <name>Task 3: Integrate task queue with PlanningOrchestrator</name>
  <files>osint_system/agents/planning_agent.py, tests/orchestration/test_task_queue.py</files>
  <action>
    Update PlanningOrchestrator to use TaskQueue for managing subtasks. Modify assign_agents method to create tasks in queue. Update coordinate_execution to pull from queue based on priority.

    Add distribute_tasks method that matches tasks to agents using registry capabilities. Update evaluate_findings to use signal analysis and coverage metrics for routing decisions.

    Create unit tests for: task prioritization logic, signal strength calculation, coverage metrics updates, diminishing returns detection. Mock agent registry responses.
  </action>
  <verify>uv run python -m pytest tests/orchestration/test_task_queue.py -v</verify>
  <done>TaskQueue integrated with orchestrator, tests pass for prioritization and distribution</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `uv run python -m pytest tests/orchestration/test_task_queue.py` passes
- [ ] Tasks are prioritized correctly based on relevance signals
- [ ] Coverage metrics track diversity and completeness
- [ ] Diminishing returns detection prevents redundant work
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Task prioritization demonstrates intelligent ordering
- Coverage metrics accurately reflect investigation breadth
- Integration with PlanningOrchestrator seamless
</success_criteria>

<output>
After completion, create `.planning/phases/3-planning-orchestration/03-02-SUMMARY.md`:

# Phase 3 Plan 2: Task Queue and Distribution Summary

**Task prioritization and distribution system with signal analysis and coverage tracking**

## Accomplishments

- Priority-based task queue
- Signal strength analysis
- Coverage metrics tracking
- Diminishing returns detection

## Files Created/Modified

- `osint_system/orchestration/task_queue.py` - Priority queue implementation
- `osint_system/orchestration/refinement/analysis.py` - Signal and coverage analysis
- `osint_system/agents/planning_agent.py` - Integration updates
- `tests/orchestration/test_task_queue.py` - Unit tests

## Decisions Made

[Key decisions and rationale]

## Issues Encountered

[Problems and resolutions]

## Next Step

Ready for 03-03-PLAN.md: Supervisor-Worker Coordination Patterns
</output>
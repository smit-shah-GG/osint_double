---
phase: 02-base-agent-architecture
plan: 04
type: execute
---

<objective>
Implement MCP tool server and validate the complete architecture.

Purpose: Create MCP server for tool exposure and test the entire agent architecture end-to-end.
Output: Working MCP tool server, example tool implementation, successful integration test.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/2-base-agent-architecture/2-RESEARCH.md
@.planning/phases/2-base-agent-architecture/2-CONTEXT.md
@.planning/phases/2-base-agent-architecture/02-01-SUMMARY.md
@.planning/phases/2-base-agent-architecture/02-02-SUMMARY.md
@.planning/phases/2-base-agent-architecture/02-03-SUMMARY.md
@osint_system/agents/base_agent.py
@osint_system/orchestration/coordinator.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement MCP tool server</name>
  <files>osint_system/tools/mcp_server.py</files>
  <action>Create MCP server using patterns from RESEARCH.md. Use Server class from mcp.server. Implement @server.tool() decorator pattern for exposing tools. Add web_scraper stub tool that returns mock data for now. Add search_tool stub that simulates API search. Include proper error handling and validation. Set up stdio_server for communication. Add async main() function with proper lifecycle management.</action>
  <verify>python osint_system/tools/mcp_server.py --help 2>&1 | grep -q "server" || echo "Server can be imported"</verify>
  <done>MCP server implemented with example tools, can be imported without errors</done>
</task>

<task type="auto">
  <name>Task 2: Create integration test script</name>
  <files>tests/test_integration.py</files>
  <action>Write integration test that: Creates MessageBus and AgentRegistry instances. Spawns 2 SimpleAgent instances with different names. Has agents broadcast capabilities via bus. Verifies registry discovers both agents. Creates Coordinator and attempts simple workflow. Tests message passing between agents. Validates supervisor routing decisions. Use asyncio.run() for async execution. Add comprehensive assertions and error messages.</action>
  <verify>python tests/test_integration.py 2>&1 | grep -E "(PASSED|SUCCESS|OK)" || echo "Test created"</verify>
  <done>Integration test created, exercises all major components</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete multi-agent architecture with LangGraph, MCP, and message bus</what-built>
  <how-to-verify>
    1. Run: python tests/test_integration.py
    2. Verify: Agents register and discover each other
    3. Verify: Messages pass between agents
    4. Verify: Supervisor routes tasks correctly
    5. Check: osint_system/cli/main.py status command shows new components
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] MCP server exposes tools correctly
- [ ] Integration test passes
- [ ] All components work together
- [ ] No race conditions or deadlocks
- [ ] Verbose logging shows agent interactions
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Integration test demonstrates working swarm
- MCP tools accessible to agents
- Phase 2 architecture complete
</success_criteria>

<output>
After completion, create `.planning/phases/2-base-agent-architecture/02-04-SUMMARY.md`:

# Phase 2 Plan 4: MCP Tool Server & Integration Summary

**[One-liner about what was accomplished]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `file.py` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 2 complete, ready for Phase 3
</output>
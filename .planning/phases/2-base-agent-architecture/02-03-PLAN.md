---
phase: 02-base-agent-architecture
plan: 03
type: execute
---

<objective>
Implement LangGraph supervisor for agent orchestration.

Purpose: Create the supervisor pattern for coordinating multiple agents using LangGraph.
Output: Working LangGraph supervisor, basic workflow graph, routing logic for agent coordination.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/2-base-agent-architecture/2-RESEARCH.md
@.planning/phases/2-base-agent-architecture/2-CONTEXT.md
@.planning/phases/2-base-agent-architecture/02-01-SUMMARY.md
@.planning/phases/2-base-agent-architecture/02-02-SUMMARY.md
@osint_system/agents/base_agent.py
@osint_system/agents/simple_agent.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create LangGraph supervisor base</name>
  <files>osint_system/orchestration/supervisor.py</files>
  <action>Implement SupervisorAgent using LangGraph patterns from RESEARCH.md. Create supervisor_node function that analyzes messages and decides routing. Use ChatAnthropic with Gemini client wrapper. Define agent routing logic based on task keywords (research, analysis, extraction). Include state management using MessagesState. Add methods for registering worker agents and their capabilities.</action>
  <verify>python -c "from osint_system.orchestration.supervisor import SupervisorAgent; sup = SupervisorAgent(); print('Supervisor created')"</verify>
  <done>SupervisorAgent class exists, can be instantiated, routing logic defined</done>
</task>

<task type="auto">
  <name>Task 2: Build workflow graph structure</name>
  <files>osint_system/orchestration/graphs/base_graph.py</files>
  <action>Create workflow graph using StateGraph from langgraph. Add supervisor as entry point. Create placeholder nodes for future agents (research_agent, analysis_agent). Define edges: supervisor routes to agents, agents return to supervisor. Add conditional edges based on supervisor decisions. Implement compile() method to create executable app. Use END node for workflow completion.</action>
  <verify>python -c "from osint_system.orchestration.graphs.base_graph import create_base_graph; graph = create_base_graph(); print('Graph created')"</verify>
  <done>Graph structure created, nodes and edges defined, compiles without error</done>
</task>

<task type="auto">
  <name>Task 3: Add agent coordination logic</name>
  <files>osint_system/orchestration/coordinator.py</files>
  <action>Create Coordinator class that ties supervisor, registry, and message bus together. Implement execute_workflow(objective: str) method. Add logic to: discover available agents via registry, construct graph dynamically based on available agents, route tasks through supervisor, collect results from agents. Handle agent failures gracefully with fallback to SimpleAgent. Add verbose logging of all routing decisions.</action>
  <verify>python -c "from osint_system.orchestration.coordinator import Coordinator; coord = Coordinator(); print('Coordinator ready')"</verify>
  <done>Coordinator integrates all components, can build dynamic workflows, handles failures</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Supervisor can make routing decisions
- [ ] Graph structure compiles successfully
- [ ] Coordinator integrates registry and bus
- [ ] Imports work without circular dependencies
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- LangGraph patterns properly implemented
- Supervisor pattern matches research recommendations
</success_criteria>

<output>
After completion, create `.planning/phases/2-base-agent-architecture/02-03-SUMMARY.md`:

# Phase 2 Plan 3: LangGraph Orchestration Summary

**[One-liner about what was accomplished]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `file.py` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 02-04-PLAN.md
</output>